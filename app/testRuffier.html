<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>Fitbit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- build:css styles/main.css -->
    <link rel="stylesheet" href="styles/styleRuffier.css">
    <!-- endbuild -->

    <!-- build:js scripts/jquery.js -->
    <script src="scripts/jquery.js"></script>
    <!-- endbuild -->

    <!-- build:js scripts/main.js -->
    <script src="scripts/fitbit.js"></script>
    <!-- endbuild -->

    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>google.charts.load('current', {'packages': ['line']});</script>

</head>
<body>

<textarea cols="500" id="url_api">https://api.fitbit.com/1/user/-/activities/heart/date/today/1d/1sec/time/13:00/13:01.json</textarea><button id="sub">Get</button>

<script type="text/javascript">
    $('#sub').click(function() {
        var url = $('#url_api').val();
        getData(url);
    });
</script>

<pre id="result"></pre>

<button id="startRuffier">Commencer le test de Ruffier</button>

<script type="text/javascript">
    var startButton = $('#startRuffier');
    startButton.click(function(){
        startButton.hide();
        $('#cardiacRythmAtStart').show();
    })
</script>

<div id="cardiacRythmAtStart">
    <textarea cols="200"  placeholder="Veuillez entrer votre rythme cardiaque avant de commencer l'exercice"></textarea>
    <button id="validate1">Valider</button>
</div>

<script type="text/javascript">
    var shallContinue = true;

    $('#endExercise').click(function(){
        shallContinue = false;
    })

    $('#validate1').click(function(){
        $('#cardiacRythmAtStart').hide();
        $('#testRuffier').show();
        $('#actualTest').hide();

        setInterval(function(){
            var timer = $('#timerBeforeStart');
            var timerValue = parseInt(timer.text());
            timer.text(timerValue - 1);
            if(timerValue == 0){
                clearInterval();
                var startTime = new Date().getTime();
                $('#countDown1').hide();
                $('#actualTest').show();
                setInterval(function(){
                    var actualTime = new Date().getTime();
                    $('#testTimer').text(Math.floor((actualTime - startTime)/1000));
                    if(!shallContinue)
                        clearInterval();
                }, 1000)
            }
        }, 1000);
    })
</script>

<div id="testRuffier">
    <div id="countDown1">
        <h2>Réalisez 9999 pompes en 45 secondes. Appuyez sur le bouton une fois terminé.</h2>
        <h2>Préparez vous, le test commencera dans <a id="timerBeforeStart">1</a> secondes</h2>
    </div>
    <div id="actualTest">
        <h2>Réalisez 9999 pompes en 45 secondes. Appuyez sur le bouton une fois terminé.</h2>
        <h2>Votre temps actuel est de <a id="testTimer">0</a> secondes</h2>
        <button id="endExercise">J'ai fini l'exercice</button>
    </div>
</div>

</body>
</html>
